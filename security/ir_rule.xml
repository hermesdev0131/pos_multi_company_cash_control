<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="0">
        <!--
            Record Rule: Allow POS users to read orders from companies they have access to

            This rule is necessary because the multi-company cash control module
            creates orders in different companies (fiscal vs non-fiscal) based on routing rules.

            Without this rule, users get "Access Error" when the POS tries to read back
            an order that was created in a company different from their current session company.

            Security Note:
            - This is READ-ONLY access (no write/create/delete)
            - Only applies to POS users (point_of_sale.group_pos_user)
            - Respects user's company access rights (company_ids)
            - Users must be granted access to fiscal and non-fiscal companies in their user settings
        -->
        <record id="pos_order_multi_company_read_rule" model="ir.rule">
            <field name="name">POS Order: Multi-Company Cash Control Read Access</field>
            <field name="model_id" ref="point_of_sale.model_pos_order"/>
            <field name="domain_force">[('company_id', 'in', company_ids)]</field>
            <field name="groups" eval="[(4, ref('point_of_sale.group_pos_user'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!--
            Record Rule: Allow POS users to read payments from companies they have access to

            When orders are created in different companies, their related payment records
            also need to be readable for the POS to function correctly.
        -->
        <record id="pos_payment_multi_company_read_rule" model="ir.rule">
            <field name="name">POS Payment: Multi-Company Cash Control Read Access</field>
            <field name="model_id" ref="point_of_sale.model_pos_payment"/>
            <field name="domain_force">[('company_id', 'in', company_ids)]</field>
            <field name="groups" eval="[(4, ref('point_of_sale.group_pos_user'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>
    </data>
</odoo>
